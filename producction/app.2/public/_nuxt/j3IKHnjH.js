import{_ as U,A,B as d,r as y,g as T,c as s,a as t,k as b,F as J,p as O,x as M,d as i,y as B,t as p,m as N,v as K,j as Z,o as n,n as j,C as H}from"./-XG8-ux0.js";import{u as $}from"./ChvDBiId.js";import{u as G}from"./Dl3r-oLy.js";const Q={class:"checkout-container"},W={class:"section"},X=["value"],Y=["value"],ee=["value"],te=["value"],le={class:"section"},ae={class:"payment-methods"},oe=["value"],se=["src","alt"],ne={key:0,class:"check-icon"},ue={key:0,class:"payment-info-card"},ie={key:0},re={key:1},de={key:2},pe={class:"summary"},ve=["disabled"],ce={key:0,class:"warning-text"},me={__name:"[slug]",setup(ge){const S=[{value:"pagoMovil",label:"Pago M√≥vil",image:"/images/pago-movil.png"},{value:"zelle",label:"Zelle",image:"/images/zelle.png"},{value:"binance",label:"Binance",image:"/images/binance.png"}],R=Z(),v=A(),{raffles:x,fetchRaffles:q}=$(),{submitTicket:D}=G(),_=v.params.slug,c=Number(v.query.quantity||0),m=Number(v.query.total||0),V=v.query.orderId,h=d(()=>x.value.find(a=>a.slug===_)),w=`
04141234567
J12345678
0134
${m}
`,r=y({fullName:""}),k=d(()=>l.value.paymentMethod&&l.value.extraInfo!==null&&String(l.value.extraInfo).trim().length>0);T(()=>{r.value=JSON.parse(localStorage.getItem("checkoutUser")||"{}")});const u=y(""),I=d(()=>u.value&&u.value.toString().length===4&&parseInt(u.value)>=0&&parseInt(u.value)<=9999);d(()=>u.value&&u.value.toString().length===4&&!I.value);const P=a=>{let e=a.target.value;e=e.replace(/[^0-9]/g,""),e.length>4&&(e=e.slice(0,4)),u.value=e,a.target.value=e,I.value&&console.log("PIN v√°lido:",e)},z=a=>{!/[0-9]/.test(a.key)&&!["Backspace","Delete","Tab","Enter","ArrowLeft","ArrowRight"].includes(a.key)&&a.preventDefault()},l=y({paymentMethod:"",extraInfo:""}),g=y(!1);d(()=>l.value.paymentMethod&&String(l.value.extraInfo||"").trim()!==""),T(()=>{x.value.length||q()});async function F(){g.value=!0;const a=await D(l.value,_,c,m,V);g.value=!1,console.log("Result: ",a),a.success?(localStorage.setItem("orderConfirmationData",JSON.stringify({quantity:c,totalNumber:c,total:m,paymentMethod:l.value.paymentMethod})),R.push("/checkout/confirmation"),console.log("Rifa: ",h.value.title)):alert("‚ùå Ocurri√≥ un error al registrar la compra")}const E=async a=>{var e;if(a.preventDefault(),(e=navigator==null?void 0:navigator.clipboard)!=null&&e.writeText)try{await navigator.clipboard.writeText(w),alert("‚úÖ Datos copiados al portapapeles")}catch(f){alert("‚ùå No se pudieron copiar los datos"),console.error(f)}else alert("‚ùå Esta funci√≥n no es compatible con tu navegador o est√°s en HTTP")};return(a,e)=>{var f,C;return n(),s("div",Q,[e[13]||(e[13]=t("h1",{class:"title"},"Finalizar Compra",-1)),t("form",{onSubmit:K(F,["prevent"]),class:"form"},[t("div",W,[e[4]||(e[4]=t("h2",{class:"section-title"},"Datos del comprador",-1)),t("input",{value:r.value.fullName,type:"text",disabled:""},null,8,X),t("input",{value:r.value.cedula,type:"text",disabled:""},null,8,Y),t("input",{value:r.value.phone,type:"text",disabled:""},null,8,ee),t("input",{value:r.value.email,type:"text",disabled:""},null,8,te)]),t("div",le,[e[11]||(e[11]=t("h2",{class:"section-title"},"M√©todo de pago",-1)),t("div",ae,[(n(),s(J,null,O(S,o=>t("label",{key:o.value,class:j(["payment-option",{selected:l.value.paymentMethod===o.value}])},[M(t("input",{type:"radio",name:"paymentMethod",value:o.value,"onUpdate:modelValue":e[0]||(e[0]=L=>l.value.paymentMethod=L),hidden:""},null,8,oe),[[H,l.value.paymentMethod]]),t("img",{src:o.image,alt:o.label},null,8,se),l.value.paymentMethod===o.value?(n(),s("div",ne,"‚úî")):b("",!0)],2)),64))]),l.value.paymentMethod?(n(),s("div",ue,[l.value.paymentMethod==="pagoMovil"?(n(),s("div",ie,[e[5]||(e[5]=t("h3",null,"üì≤ Pago M√≥vil",-1)),e[6]||(e[6]=t("p",null,[t("b",null,"Banco:"),i(" Banesco - 0134")],-1)),e[7]||(e[7]=t("p",null,[t("b",null,"Tel√©fono:"),i(" 0424-8362674")],-1)),e[8]||(e[8]=t("p",null,[t("b",null,"C.I:"),i(" 19.939.353")],-1)),t("button",{onClick:E},"üìã Copiar datos")])):l.value.paymentMethod==="zelle"?(n(),s("div",re,e[9]||(e[9]=[t("h3",null,"üè¶ Zelle",-1),t("p",null,[t("b",null,"Correo:"),i(" topCapsphoenix@gmail.com")],-1),t("p",null,[t("b",null,"Titular:"),i(" Topcapsphoenix LLC")],-1)]))):l.value.paymentMethod==="binance"?(n(),s("div",de,e[10]||(e[10]=[t("h3",null,"ü™ô Binance",-1),t("p",null,[t("b",null,"Correo:"),i(" aquilitoo12@gmail.com")],-1)]))):b("",!0),l.value.paymentMethod==="pagoMovil"?M((n(),s("input",{key:3,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.extraInfo=o),onInput:P,onKeypress:z,onFocus:e[2]||(e[2]=o=>o.target.select()),type:"number",min:"0",max:"9999",step:"1",placeholder:"Ingrese los √∫ltimos 4 d√≠gitos",required:""},null,544)),[[B,l.value.extraInfo]]):M((n(),s("input",{key:4,"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.extraInfo=o),type:"email",placeholder:"Correo desde el que pagaste",required:""},null,512)),[[B,l.value.extraInfo]])])):b("",!0)]),t("div",pe,[e[12]||(e[12]=t("h2",{class:"section-title"},"Resumen",-1)),t("p",null,"Rifa: "+p((f=h.value)==null?void 0:f.title),1),t("p",null,"Boletos: "+p(N(c)),1),t("p",null,"Precio por boleto: Bs. "+p((C=h.value)==null?void 0:C.price),1),t("p",null,"Total: Bs. "+p(N(m)),1)]),t("button",{class:"submit-btn",type:"submit",disabled:g.value||!k.value},p(g.value?"Enviando...":"Verificar Pago"),9,ve),k.value?b("",!0):(n(),s("p",ce," Por favor selecciona un m√©todo de pago y completa los datos requeridos. "))],32)])}}},he=U(me,[["__scopeId","data-v-865c42b2"]]);export{he as default};
